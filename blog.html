<!DOCTYPE html>
<html lang="en">
<script>
	 	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	 	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	 	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	 	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	 	
	 	ga('create', 'UA-37298602-1', 'auto');
	 	ga('send', 'pageview');
	 	
	 </script>
    <head>
        <title>Thanh-Dat Truong</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="author" content="owwwlab.com">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        
        <meta name="description" content="Thanh-Dat Truong's Academic Webpage" />
        <meta name="keywords" content="faculty profile, theme,css, html, jquery, transition, transform, 3d, css3" />

        <link rel="shortcut icon" href="../favicon.ico">

        <!--CSS styles-->
        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/font-awesome.css">
        <link rel="stylesheet" href="css/perfect-scrollbar-0.4.5.min.css">
        <link rel="stylesheet" href="css/magnific-popup.css">
        <link rel="stylesheet" href="css/style.css">
        <link id="theme-style" rel="stylesheet" href="css/styles/default.css">

        
        <!--/CSS styles-->
        <!--Javascript files-->
        <script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
        <script type="text/javascript" src="js/TweenMax.min.js"></script>
        <script type="text/javascript" src="js/jquery.touchSwipe.min.js"></script>
        <script type="text/javascript" src="js/jquery.carouFredSel-6.2.1-packed.js"></script>
        
        <script type="text/javascript" src="js/modernizr.custom.63321.js"></script>
        <script type="text/javascript" src="js/jquery.dropdownit.js"></script>

        <script type="text/javascript" src="js/ScrollToPlugin.min.js"></script>

        <script type="text/javascript" src="js/bootstrap.min.js"></script>

        <script type="text/javascript" src="js/jquery.mixitup.min.js"></script>

        <script type="text/javascript" src="js/masonry.min.js"></script>

        <script type="text/javascript" src="js/perfect-scrollbar-0.4.5.with-mousewheel.min.js"></script>
        <script type="text/javascript" src="js/jquery.nicescroll.min.js"></script>
        
        <script type="text/javascript" src="js/magnific-popup.js"></script>
        <script type="text/javascript" src="js/custom.js"></script>

        <!--/Javascript files-->

    </head>
    <body>

        <div id="wrapper">
            <a href="#sidebar" class="mobilemenu"><i class="fa fa-reorder"></i></a>

            <div id="sidebar">
                <div id="sidebar-wrapper">
                    <div id="sidebar-inner">
                        <!-- Profile/logo section-->
                        <div id="profile" class="clearfix">
                            <div class="portrate hidden-xs"><img class="logo-khtn" src="img/personal/logo-khtn.png" alt=""></div>
                            <div class="title">
                                <h2>Thanh-Dat Truong</h2>
                                <h3>University of Science</h3>
                                <h3>Vietnam National University</h3>
                                <h3>Ho Chi Minh City</h3>
                            </div>   
                        </div>
                        <!-- /Profile/logo section-->

                        <!-- Main navigation-->
                        <div id="main-nav">
                            <ul id="navigation">
                                <li>
                                  <a href="index.html">
                                    <i class="fa fa-home"></i>
                                    <div class="text">Home</div>
                                  </a>
                                </li>  
                                <li>
   							<a href="bio.html">
   								<i class="fa fa-user"></i>
   								<div class="text">About Me</div>
   							</a>
   						</li>  
                                <li class="currentmenu">
                                  <a href="research.html">
                                    <i class="fa fa-book"></i>
                                    <div class="text">Research</div>
                                  </a>
                                </li> 
                                
                                <li>
                                  <a href="publication.html">
                                    <i class="fa fa-edit"></i>
                                    <div class="text">Publications</div>
                                  </a>
                                </li> 
								<li>
                                    <a href="project.html">
                                        <i class="fa fa-file-code-o"></i>
                                        <div class="text">Projects</div>
                                    </a>
                                </li>
                                <li>
                                  <a href="contact.html">
                                      <i class="fa fa-calendar"></i>
                                      <div class="text">Contact Me</div>
                                  </a>
                                </li>

                       
                            </ul>
                        </div>
                        <!-- /Main navigation-->
                        <!-- Sidebar footer -->
                        <div id="sidebar-footer">
                            <div class="social-icons">
                                <ul>
                                    <li><a href="https://www.linkedin.com/in/thanh-dat-truong-098544144/"><i class="fa fa-linkedin"></i></a></li>
                                </ul>
                            </div>

                    
                        </div>
                        <!-- /Sidebar footer -->
                    </div>

                </div>
            </div>

            <div id="main">
            
                <div id="research" class="page">
                    <div class="pageheader">
                        <div class="headercontent">
                            <div class="section-container">
                                <h2 class="title">Research</h2>
                            </div>
                        </div>
                    </div>

                    <div class="pagecontents">
                        <div class="section color-2">
                            <div class="section-container">
                                <h2 class="title">Research Summary</h2>
                            
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="tip" markdown="1">
                                                # Generative Discriminative Networks - GANs

                                                ## GANs là gì?
                                                
                                                GANs là một thuật toán học không giám sát (Unsupersived Learning) được Ian Goodfellow giới thiệu vào năm 2014 tại hội nghị NIPS, trong đó bao gồm hai thành phần chính là ***Generator*** và ***Discriminator***:
                                                
                                                - ***Generator*** (ký hiệu $G$) nhận nhiệm vụ học ra cách áp xạ từ một không gian tìm ẩn $Z$  (*a latent space*) vào một không gian với phân phối từ dữ liệu cho trước.
                                                
                                                - ***Discriminator*** (ký hiệu $D$) nhận nhiệm vụ phân biệt dữ liệu được tạo ra từ $G$ và dữ liệu cho trước.
                                                
                                                Một cách toán học: Giả sử ta có $z \in Z$ có $z \sim p_Z(z)$, dữ liệu cho trước $x$ có $x \sim p_{data}(x)$ ($x$ gọi là *real data*). Ta có $G$ sẽ ánh xạ $z$ không gian dữ liệu cho trước $\hat{x}=G(z)$ ($\hat{x}$ gọi là *fake data*). $D(x)$ là xác suất mà $x$ là *real data* hay *fake data*. Mục tiêu của GANs là làm sao cho $G$ cố gắng tạo ra được $\hat{x}$ sao cho $D$ không còn thể phân biệt được là *fake data*. Tối ưu $G$ và $D$ giống như trò chơi $minimax$ với hàm mục tiêu $V(D, G)$, trong đó $G$ cố gắng làm tăng xác suất mà $\hat{x}$ được tạo ra là *real data* và $D$ thì cố gắng làm điều ngược lại.
                                                
                                                $$ \min_{G} \max_{D} V(D, G) = \mathbb{E}_{x \sim p_{data}(x)}[log D(x)] + \mathbb{E}_{z \sim p_Z(z)}[log(1 - D(G(z)))]$$
                                                
                                                ## Tối ưu GANs
                                                
                                                Qúa tình tối ưu GANs cũng khá đơn giản:
                                                
                                                1. Lấy ngẫu nhiên $m$ mẫu$z \in Z$ và $m$ mẫu $x$ từ dữ liệu cho trước.
                                                2. Tối ưu $D$ dựa trên $z$ và $x$.
                                                3. Lấy ngẫu nhiên $m$ mẫu $z \in Z$ (có thể dùng lại $z$ ở bước 1).
                                                4. Tối ưu $G$ dựa trên $z$.
                                                5. Quay lại bước $1$.
                                                
                                                ## Minh hoạ bằng Python với Tensorflow
                                                
                                                Sau đây mình sẽ minh hoạ GAN với tập dữ liệu MNIST.  Toàn bộ mã nguồn có thể tìm được [tại đây](https://gist.github.com/truongthanhdat/595e9c95990f36dfea9e8ff66fd72b42)
                                                
                                                Trước tiên mình cần cài đặt thư viện [Tensorflow](tensorflow.org) cho Python 
                                                
                                                ```bash
                                                [sudo] pip install tensorflow #Hoặc tensorflow-gpu đối với các bạn sử dụng Tensorflow với GPU
                                                ```
                                                
                                                Trước tiên ta cần khai bái các thư viện cần thiết:
                                                
                                                ```python
                                                import tensorflow as tf
                                                import tensorflow.contrib.slim as slim #slim cho phép khai báo nhanh các lớp thông dụng
                                                import numpy as np
                                                from tensorflow.examples.tutorials.mnist import input_data #Tensorfow cung cấp sẵn API để lấy dữ liệu từ tập MNIST
                                                ```
                                                
                                                Ta cần định nghĩa $G$ và $D$, ở đây mình sử dụng một mạng truyền thẳng (*feed-forward*) đơn giản với một lớp ẩn:
                                                
                                                ```python
                                                def generator(inputs):
                                                    with tf.variable_scope("generator"):
                                                        net = slim.fully_connected(inputs, 256, scope = "fc1")
                                                        net = slim.fully_connected(net, 784, scope = "fake_images", activation_fn = tf.nn.sigmoid)
                                                    return net
                                                
                                                def discriminator(inputs):
                                                    with tf.variable_scope("discriminator"):
                                                        net = slim.fully_connected(inputs, 256, scope = "fc1")
                                                        net = slim.fully_connected(net, 1, scope = "predictions", activation_fn = tf.nn.sigmoid)
                                                    return net
                                                ```
                                                
                                                Ta đinh nghĩa  các hyperparameters cần thiết:
                                                
                                                ```python
                                                mnist_loader = input_data.read_data_sets('MNIST_data')
                                                batch_size = 32
                                                z_dim = 100 #Số chiều của Z
                                                learning_rate = 0.0002
                                                num_iters = 100000
                                                ```
                                                
                                                Sau đó ta khởi tạo mạng:
                                                
                                                ```python
                                                random_z = tf.placeholder(shape = [batch_size, z_dim], dtype = tf.float32, name = "random_vector") #vector z
                                                real_images = tf.placeholder(shape = [batch_size, 784], dtype = tf.float32, name = "real_images") #real data
                                                fake_images = generator(random_z) #fake data
                                                
                                                predictions = discriminator(tf.concat([real_images, fake_images], axis = 0)) #fake và real data được đưa qua Discriminator
                                                real_preds = tf.slice(predictions, [0, 0], [batch_size, -1])
                                                fake_preds = tf.slice(predictions, [batch_size, 0], [batch_size, -1])
                                                ```
                                                
                                                Sau đó ta định nghĩa hàm mất cho ***Generator*** và ***Discriminator***. Ở đây mình sử dụng Adam Optimizer để tối ưu $G$ và $D$.
                                                
                                                ```python
                                                gen_loss = -tf.reduce_mean(tf.log(fake_preds))
                                                dis_loss = -tf.reduce_mean(tf.log(real_preds) + tf.log(1. - fake_preds))
                                                
                                                gen_vars = slim.get_variables(scope = "generator")
                                                dis_vars = slim.get_variables(scope = "discriminator")
                                                
                                                optimizer = tf.train.AdamOptimizer(learning_rate)
                                                gen_train_op = optimizer.minimize(gen_loss, var_list = gen_vars)
                                                dis_train_op = optimizer.minimize(dis_loss, var_list = dis_vars)
                                                ```
                                                Sau đó ta tiến hành tối ưu $G$ và $D$
                                                
                                                ```python
                                                sess = tf.Session()
                                                sess.run(tf.global_variables_initializer())
                                                for iter in xrange(1, num_iters + 1):
                                                    ## Vector ngẫu nhiên z được lấy từ phân phối đều trên [-1, 1]
                                                    feed_dict = {
                                                            random_z: np.random.uniform(-1., 1., size=[batch_size, z_dim]),
                                                            real_images: mnist_loader.train.next_batch(batch_size=batch_size)[0]
                                                            }
                                                    _, _, _gen_loss, _dis_loss = sess.run(
                                                            [gen_train_op, dis_train_op, gen_loss, dis_loss],
                                                            feed_dict = feed_dict
                                                            )
                                                            
                                                    if (iter % 50) == 0:
                                                        print("Iteration [{:06d}/{:06d}]".format(iter, num_iters))
                                                        print("\t>> Generator Loss: {}".format(_gen_loss))
                                                        print("\t>> Discriminator Loss: {}".format(_dis_loss))
                                                ```
                                                
                                                ## Ứng dụng của GANs và Những điều lưu ý
                                                
                                                Trong những năm gần đây, GAN đã có những ứng dụng mạnh mẽ trong nhiều bài toán như Image Super Resolution, Image Translation, Domain Adaptaion. Tuy nhiên để tối ưu GANs là điều không phải dễ, điều này đòi hỏi về phần cứng cũng như sự phân tích bài toán:
                                                
                                                - GAN đòi hỏi chi phí phần cứng cao với các bài toán xử lý ảnh có kích thước lớn.
                                                
                                                - Việc điều chỉnh *Learning Rate* cũng không phải là điểu dễ dàng, phải cân bằng làm sao cho ***Discriminator*** và ***Generator*** cân bằng lẫn nhau, nếu không dễ dẫn đến một bên lấn áp phần còn lại, dẫn đến ***Generator*** không cho ra kết quả tốt. 
                                                
                                                Bài viết này chỉ cung cấp một khái niệm và ví dụ cơ bản nhất về GANs, nếu có gì sai sót mong các bạn có thể đóng góp kiến.
                                                
                                                ## Tham khảo
                                                
                                                1. [Generative Adversarial Networks Wiki](https://en.wikipedia.org/wiki/Generative_adversarial_network)
                                                2. [Generative Adversarial Nets.  Ian Goodfellow. NIPS 2014 ](https://papers.nips.cc/paper/5423-generative-adversarial-nets.pdf)
                                                3. [Mã nguồn tham khảo](https://gist.github.com/truongthanhdat/595e9c95990f36dfea9e8ff66fd72b42)
                                        </div>

                                        
                                    </div>
                                    <div class="col-md-4">
                                        <div class="subtitle text-center"><h3>Interests</h3> </div>
                                        <ul class="ul-boxed list-unstyled">
                                            <li>Computer Vision</li>
                                            <li>Pattern Recognition</li>
                                            <li>Multimedia Retrieval</li>
                                            <li>Lifelogging Retrieval</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                       
                        
                        

            </div>
        </div>
    </body>
</html>

